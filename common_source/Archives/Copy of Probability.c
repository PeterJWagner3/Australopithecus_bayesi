#define Probability#include "Probability.h"#include <stdlib.h>#include <stdio.h>#include <time.h>#include <math.h>#include <string.h>#define	e	2.718281828/* calculate an array that can be used to generate a Poisson distribution */int *PoissonRand(double rate, double time, double precision){int	a, b;double	x, y, sum=0;int	*result;b=y=0;x=1;while (x>=(1/precision) || sum<(precision/2))	{	x=pow(e,(-1*rate*time)) * pow((rate*time),b) / fact(b);	sum=sum+(x*precision);	++b;	}result=(int *)malloc(b*sizeof(int));y=0;for (a=0; a<b; ++a)	{	x=pow(e,(-1*rate*time)) * pow((rate*time),a) / fact(a);	y=y+(x*(precision*precision)/sum);	result[a]=y;	if (y-result[a]>0.5)	++result[a];	}return result;}/* Calculate a factorial for interger d */int fact(int d){int	a, result;double	x, y;if (d<=1)	result=1;else	{	x=0;	for (a=2; a<=d; ++a)		x=x+log(a);		y=pow(e,x);	result=y;	if ((y-result)>0.5)	++result;	}return result;}